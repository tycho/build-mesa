diff --git a/src/meson.build b/src/meson.build
index 62c65face77..caa9c50bf74 100644
--- a/src/meson.build
+++ b/src/meson.build
@@ -65,6 +65,8 @@ else
 endif
 if with_gallium or with_gbm or with_platform_wayland
   subdir('loader')
+else
+  libloader_wayland_helper = null_dep
 endif
 if with_gallium
   subdir('mapi')
diff --git a/src/vulkan/wsi/meson.build b/src/vulkan/wsi/meson.build
index 12b037d7d69..8523a0941e2 100644
--- a/src/vulkan/wsi/meson.build
+++ b/src/vulkan/wsi/meson.build
@@ -20,6 +20,7 @@
 
 files_vulkan_wsi = files('wsi_common.c')
 platform_deps = []
+wsi_link_deps = []
 
 if dep_libdrm.found()
   files_vulkan_wsi += files('wsi_common_drm.c')
@@ -34,6 +35,7 @@ if with_platform_wayland
   files_vulkan_wsi += wp_files['linux-dmabuf-unstable-v1']
   files_vulkan_wsi += wp_files['presentation-time']
   files_vulkan_wsi += wp_files['tearing-control-v1']
+  wsi_link_deps += [libloader_wayland_helper]
 endif
 
 if with_platform_windows
@@ -68,7 +70,7 @@ libvulkan_wsi = static_library(
     idep_vulkan_runtime_headers, idep_xmlconfig, idep_mesautil, platform_deps,
     idep_blake3
   ],
-  link_with: libloader_wayland_helper,
+  link_with: wsi_link_deps,
   gnu_symbol_visibility : 'hidden',
   build_by_default : false,
 )
